# Device version

CUDA Device: Quadro P4000 Pascal
Compute Capability: 6.1
Max Threads per Block: 1024
| **Parameter**    | **Details**                       |
|------------------|---------------------------------|
| GPU Model        | NVIDIA Quadro P4000 (8 GB VRAM) |
| CUDA Version     | 12.8                            |
| Driver Version   | 550.144.03                      |
| Memory Available | 8 GB total (2 MiB currently used)|

Max threads per block: 1024
Max threads per multiprocessor: 2048
Number of multiprocessors (SMs): 14
Max threads per GPU: 28672

Global memory size: 8106 MB
Shared memory per block: 48 KB
Registers per block: 65536



# V1-- baseline

CUDA Device: Quadro P4000
Compute Capability: 6.1
Max Threads per Block: 1024
Max Block Dimensions: 1024 x 1024 x 64

+-----------+------------+----------------+----------------+----------------+
| Matrix    | Block Size | Threads/Block  | Time (ms)      | Performance    |
| Size      | (threads)  | Total          |                | (GFLOPS)       |
+-----------+------------+----------------+----------------+----------------+
|  256 x 256 |  8 x  8    |    65536       |      0.213     |     157.79     |
|  256 x 256 | 16 x 16    |    65536       |      0.159     |     211.51     |
|  256 x 256 | 32 x 32    |    65536       |      0.180     |     185.92     |
|  512 x 512 |  8 x  8    |   262144       |      1.571     |     170.88     |
|  512 x 512 | 16 x 16    |   262144       |      1.061     |     253.11     |
|  512 x 512 | 32 x 32    |   262144       |      1.089     |     246.48     |
| 1024 x1024 |  8 x  8    |  1048576       |     13.684     |     156.94     |
| 1024 x1024 | 16 x 16    |  1048576       |      9.125     |     235.35     |
| 1024 x1024 | 32 x 32    |  1048576       |      8.753     |     245.35     |
| 2048 x2048 |  8 x  8    |  4194304       |    104.365     |     164.61     |
| 2048 x2048 | 16 x 16    |  4194304       |     61.546     |     279.14     |
| 2048 x2048 | 32 x 32    |  4194304       |     54.112     |     317.49     |
+-----------+------------+----------------+----------------+----------------+


V2-- unroll
+----------+----------------+------------+----------------+----------------+
| Version  | Matrix Size    | Block Size | Time (ms)      | Performance    |
|          |                |            |                | (GFLOPS)       |
+----------+----------------+------------+----------------+----------------+
Running V2 Loop Unroll Kernel
| V2_Unroll |  512 x  512     | 16 x 16    |      1.061     |     253.02     |
Running V2 Loop Unroll Kernel
| V2_Unroll |  512 x  512     | 32 x 32    |      1.088     |     246.67     |
+----------+----------------+------------+----------------+----------------+
Running V2 Loop Unroll Kernel
| V2_Unroll | 1024 x 1024     | 16 x 16    |      9.088     |     236.30     |
Running V2 Loop Unroll Kernel
| V2_Unroll | 1024 x 1024     | 32 x 32    |     15.887     |     135.17     |
+----------+----------------+------------+----------------+----------------+
Running V2 Loop Unroll Kernel
| V2_Unroll | 2048 x 2048     | 16 x 16    |     72.972     |     235.43     |
Running V2 Loop Unroll Kernel
| V2_Unroll | 2048 x 2048     | 32 x 32    |     72.903     |     235.65     |
+----------+----------------+------------+----------------+----------------+


V3-- shared memory

+----------+----------------+------------+----------------+----------------+
| Version  | Matrix Size    | Block Size | Time (ms)      | Performance    |
|          |                |            |                | (GFLOPS)       |
+----------+----------------+------------+----------------+----------------+
Running V3 Shared Memory Kernel
| V3_Shared |  512 x  512     | 16 x 16    |      0.521     |     515.25     |
Running V3 Shared Memory Kernel
| V3_Shared |  512 x  512     | 32 x 32    |      0.000     | 3677198.03     |
+----------+----------------+------------+----------------+----------------+
Running V3 Shared Memory Kernel
| V3_Shared | 1024 x 1024     | 16 x 16    |      4.183     |     513.43     |
Running V3 Shared Memory Kernel
| V3_Shared | 1024 x 1024     | 32 x 32    |      0.000     | 39045157.24     |
+----------+----------------+------------+----------------+----------------+
Running V3 Shared Memory Kernel
| V3_Shared | 2048 x 2048     | 16 x 16    |     33.255     |     516.60     |
Running V3 Shared Memory Kernel
| V3_Shared | 2048 x 2048     | 32 x 32    |      0.000     | 256415957.97     |
+----------+----------------+------------+----------------+----------------+

V4-- coarse-grained

+----------+----------------+------------+----------------+----------------+
| Version  | Matrix Size    | Block Size | Time (ms)      | Performance    |
|          |                |            |                | (GFLOPS)       |
+----------+----------------+------------+----------------+----------------+
Running V4 Thread Coarsening Kernel
| V4_Coarse |  512 x  512     | 16 x 16    |      2.812     |      95.47     |
Running V4 Thread Coarsening Kernel
| V4_Coarse |  512 x  512     | 32 x 32    |      3.463     |      77.51     |
+----------+----------------+------------+----------------+----------------+
Running V4 Thread Coarsening Kernel
| V4_Coarse | 1024 x 1024     | 16 x 16    |     21.072     |     101.91     |
Running V4 Thread Coarsening Kernel
| V4_Coarse | 1024 x 1024     | 32 x 32    |     26.948     |      79.69     |
+----------+----------------+------------+----------------+----------------+
Running V4 Thread Coarsening Kernel
| V4_Coarse | 2048 x 2048     | 16 x 16    |    185.312     |      92.71     |
Running V4 Thread Coarsening Kernel
| V4_Coarse | 2048 x 2048     | 32 x 32    |    411.498     |      41.75     |
+----------+----------------+------------+----------------+----------------+


V5-- privatization

+----------+----------------+------------+----------------+----------------+
| Version  | Matrix Size    | Block Size | Time (ms)      | Performance    |
|          |                |            |                | (GFLOPS)       |
+----------+----------------+------------+----------------+----------------+
Running V5 Privatization Kernel
| V5_Privat |  512 x  512     | 16 x 16    |      1.953     |     137.47     |
Running V5 Privatization Kernel
| V5_Privat |  512 x  512     | 32 x 32    |      0.000     | 5478274.61     |
+----------+----------------+------------+----------------+----------------+
Running V5 Privatization Kernel
| V5_Privat | 1024 x 1024     | 16 x 16    |     15.137     |     141.87     |
Running V5 Privatization Kernel
| V5_Privat | 1024 x 1024     | 32 x 32    |      0.000     | 52377649.95     |
+----------+----------------+------------+----------------+----------------+
Running V5 Privatization Kernel
| V5_Privat | 2048 x 2048     | 16 x 16    |    109.882     |     156.35     |
Running V5 Privatization Kernel
| V5_Privat | 2048 x 2048     | 32 x 32    |      0.000     | 330382099.69     |
+----------+----------------+------------+----------------+----------------+



# reference point
+----------+----------------+------------+----------------+----------------+
| Version  | Matrix Size    | Block Size | Time (ms)      | Performance    |
|          |                |            |                | (GFLOPS)       |
+----------+----------------+------------+----------------+----------------+
Running V6 cuBLAS Kernel
| V6_cuBLAS |  512 x  512     | 16 x 16    |      2.737     |      98.08     |
Running V6 cuBLAS Kernel
| V6_cuBLAS |  512 x  512     | 32 x 32    |      0.126     |    2137.82     |
+----------+----------------+------------+----------------+----------------+
Running V6 cuBLAS Kernel
| V6_cuBLAS | 1024 x 1024     | 16 x 16    |      1.052     |    2041.81     |
Running V6 cuBLAS Kernel
| V6_cuBLAS | 1024 x 1024     | 32 x 32    |      0.734     |    2925.54     |
+----------+----------------+------------+----------------+----------------+
Running V6 cuBLAS Kernel
| V6_cuBLAS | 2048 x 2048     | 16 x 16    |      5.031     |    3414.59     |
Running V6 cuBLAS Kernel
| V6_cuBLAS | 2048 x 2048     | 32 x 32    |      5.033     |    3413.57     |
+----------+----------------+------------+----------------+----------------+












+----------+----------------+------------+----------------+----------------+
| Version  | Matrix Size    | Block Size | Time (ms)      | Performance    |
|          |                |            |                | (GFLOPS)       |
+----------+----------------+------------+----------------+----------------+
| V1_Base  |  512 x  512     | 16 x 16    |      1.061     |     252.93     |
| V2_Unroll |  512 x  512     | 16 x 16    |      1.058     |     253.67     |
| V4_Coarse |  512 x  512     | 16 x 16    |      2.816     |      95.33     |
| V3_Shared |  512 x  512     | 16 x 16    |      0.524     |     512.22     |
| V6_cuBLAS |  512 x  512     | 16 x 16    |      1.900     |     141.26     |
| V1_Base  |  512 x  512     | 32 x 32    |      1.097     |     244.76     |
| V2_Unroll |  512 x  512     | 32 x 32    |      1.090     |     246.22     |
| V4_Coarse |  512 x  512     | 32 x 32    |      3.469     |      77.39     |
| V6_cuBLAS |  512 x  512     | 32 x 32    |      0.128     |    2100.75     |
+----------+----------------+------------+----------------+----------------+
| V1_Base  | 1024 x 1024     | 16 x 16    |      9.101     |     235.96     |
| V2_Unroll | 1024 x 1024     | 16 x 16    |     11.073     |     193.94     |
| V4_Coarse | 1024 x 1024     | 16 x 16    |     21.069     |     101.92     |
| V3_Shared | 1024 x 1024     | 16 x 16    |      4.179     |     513.90     |
| V6_cuBLAS | 1024 x 1024     | 16 x 16    |      6.211     |     345.74     |
| V1_Base  | 1024 x 1024     | 32 x 32    |      7.954     |     269.99     |
| V2_Unroll | 1024 x 1024     | 32 x 32    |      7.863     |     273.10     |
| V4_Coarse | 1024 x 1024     | 32 x 32    |     25.957     |      82.73     |
| V6_cuBLAS | 1024 x 1024     | 32 x 32    |      0.664     |    3232.40     |
+----------+----------------+------------+----------------+----------------+
| V1_Base  | 2048 x 2048     | 16 x 16    |     63.478     |     270.64     |
| V2_Unroll | 2048 x 2048     | 16 x 16    |     59.720     |     287.67     |
| V4_Coarse | 2048 x 2048     | 16 x 16    |    183.516     |      93.62     |
| V3_Shared | 2048 x 2048     | 16 x 16    |     23.965     |     716.87     |
| V6_cuBLAS | 2048 x 2048     | 16 x 16    |      3.777     |    4549.03     |
| V1_Base  | 2048 x 2048     | 32 x 32    |     54.537     |     315.01     |
| V2_Unroll | 2048 x 2048     | 32 x 32    |     53.736     |     319.71     |
| V4_Coarse | 2048 x 2048     | 32 x 32    |    398.899     |      43.07     |
| V6_cuBLAS | 2048 x 2048     | 32 x 32    |      3.742     |    4591.29     |
+----------+----------------+------------+----------------+----------------+